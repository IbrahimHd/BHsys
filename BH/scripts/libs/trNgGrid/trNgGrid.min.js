"use strict";var TrNgGrid;!function(e){var t;(t=e.SelectionMode||(e.SelectionMode={}))[t.None=0]="None",t[t.SingleRow=1]="SingleRow",t[t.MultiRow=2]="MultiRow",t[t.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers";var i=e.SelectionMode;e.defaultColumnOptionsTemplate={cellWidth:null,cellHeight:null,displayAlign:null,displayFormat:null,displayName:null,filter:null,enableFiltering:null,enableSorting:null},e.defaultColumnOptions={},e.translations={},e.debugMode=!1;var r=!1,n="trNgGrid";e.sortFilter=n+"SortFilter",e.dataPagingFilter=n+"DataPagingFilter",e.translateFilter=n+"TranslateFilter",e.translationDateFormat=n+"DateFormat",e.dataFormattingFilter=n+"DataFormatFilter";var l="tr-ng-grid-body",a="field-name",s="data-field-name",o="trNgGridFooterCellTemplate";e.cellFooterTemplateId=o+".html";var d="trNgGridGlobalFilter";e.globalFilterDirectiveAttribute="tr-ng-grid-global-filter",e.footerGlobalFilterTemplateId=d+".html";var g="trNgGridPager";e.pagerDirectiveAttribute="tr-ng-grid-pager",e.footerPagerTemplateId=g+".html";var c="trNgGridHeaderCell",u="trNgGridHeaderCellTemplate";e.cellHeaderTemplateId=u+".html";var p="trNgGridBodyCell",m="trNgGridBodyCellTemplate";e.cellBodyTemplateId=m+".html";var f="trNgGridColumnSort";e.columnSortDirectiveAttribute="tr-ng-grid-column-sort",e.columnSortTemplateId=f+".html";var h="trNgGridColumnFilter";e.columnFilterDirectiveAttribute="tr-ng-grid-column-filter",e.columnFilterTemplateId=h+".html";var v=function(e,t){t=t.toUpperCase();for(var i=e.children(),r=0;r<i.length;r++){var n=i[r];if(n.tagName==t)return angular.element(n)}return null},I=function(e,t,i,r){var n=[],l=t.slice(0);return angular.forEach(e,function(e){for(var t=null,i=0;!t&&i<l.length;i++)(t=l[i]).fieldName===e.fieldName?l.splice(i,1):t=null;t?n.push(t):n.push(e)}),(i||r)&&angular.forEach(l,function(e){(i&&e.fieldName||r&&!e.fieldName)&&n.push(e)}),n},O=function(e,t,i,r){if(i){var n=e.children(),l=angular.element(n[0]);if(1!==n.length||!l.attr(r)){e.empty();var a=angular.element("<div></div>").attr(r,"");e.append(a),angular.forEach(n,function(e){a.append(angular.element(e))})}}else e.empty(),e.append(angular.element("<div></div>").attr(r,""))},y=function(){return function(e,t){this.parent=e,this.cellElement=t,this.fieldName=t.attr(a)||t.attr(s);var i=t.children();this.isStandardColumn=0===i.length}}(),C=function(){function e(e,t,i,r,n){this.sectionTagName=e,this.sectionDirectiveAttribute=t,this.rowDirectiveAttribute=i,this.cellTagName=r,this.cellDirectiveAttribute=n,this.cellTagName=this.cellTagName.toUpperCase(),this.cells=null}return e.prototype.configureSection=function(e,t){var i=this,r=this.getSectionElement(e,!0);r.empty(),r.removeAttr("ng-non-bindable");var n=I(t,this.cells,!1,!1),l=this.getTemplatedRowElement(r,!0);return angular.forEach(n,function(e,t){var r,n=e;r=n.parent===i&&n.cellElement?n.cellElement.clone(!0):angular.element("<table><"+i.cellTagName+"></"+i.cellTagName+"></table>").find(i.cellTagName),i.cellDirectiveAttribute&&r.attr(i.cellDirectiveAttribute,t),e.isStandardColumn||r.attr("is-customized","true"),e.fieldName&&r.attr(a,e.fieldName),r.attr("ng-style","{'width':columnOptions.cellWidth,'height':columnOptions.cellHeight}"),l.append(r)}),r},e.prototype.extractPartialColumnDefinitions=function(){return this.cells},e.prototype.discoverTemplates=function(e){var t=this;this.cells=[],this.cellRow=null;var i=this.getTemplatedRowElement(this.getSectionElement(e,!1),!1);i&&(this.cellRow=angular.element(i.clone()),this.cellRow.empty(),angular.forEach(i.children(),function(e,i){if((e=angular.element(e))[0].tagName===t.cellTagName.toUpperCase()){var r=e.clone();t.cells.push(new y(t,r))}}))},e.prototype.getSectionElement=function(e,t){var i=null;return e&&(i=v(e,this.sectionTagName)),!i&&t&&(i=angular.element("<table><"+this.sectionTagName+"></"+this.sectionTagName+"></table>").find(this.sectionTagName),e&&e.append(i)),i&&t&&this.sectionDirectiveAttribute&&i.attr(this.sectionDirectiveAttribute,""),i},e.prototype.getTemplatedRowElement=function(e,t){var i=null;return e&&(i=v(e,"tr")),!i&&t&&(i=this.cellRow?angular.element(this.cellRow.clone()):angular.element("<table><tr></tr></table>").find("tr"),e&&e.append(i)),i&&t&&this.rowDirectiveAttribute&&i.attr(this.rowDirectiveAttribute,""),i},e}(),F=function(){function t(t,i,n,l,a){var s,o;this.$compile=t,this.$parse=i,this.$timeout=n,r||(D(s=l,o=a,e.cellHeaderTemplateId,'<div class="'+e.headerCellCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <div class="'+e.columnTitleCssClass+'">      {{columnTitle |'+e.translateFilter+":gridOptions.locale}}       <div "+e.columnSortDirectiveAttribute+'=""></div>    </div>    <div '+e.columnFilterDirectiveAttribute+'=""></div>  </div></div>'),D(s,o,e.cellBodyTemplateId,'<div ng-attr-class="'+e.bodyCellCssClass+' text-{{columnOptions.displayAlign}}" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>{{gridDisplayItem[columnOptions.displayFieldName]}}</div></div>'),D(s,o,e.columnFilterTemplateId,'<div ng-show="(gridOptions.enableFiltering&&columnOptions.enableFiltering!==false)||columnOptions.enableFiltering" class="'+e.columnFilterCssClass+'"> <div class="'+e.columnFilterInputWrapperCssClass+'">   <input class="form-control input-sm" type="text" ng-model="columnOptions.filter" ng-keypress="speedUpAsyncDataRetrieval($event)"></input> </div></div>'),D(s,o,e.columnSortTemplateId,"<div ng-attr-title=\"{{'Sort'|"+e.translateFilter+':gridOptions.locale}}" ng-show="(gridOptions.enableSorting&&columnOptions.enableSorting!==false)||columnOptions.enableSorting" ng-click="toggleSorting(columnOptions.fieldName)" class="'+e.columnSortCssClass+'" >   <div ng-class="{\''+e.columnSortActiveCssClass+"':gridOptions.orderBy==columnOptions.fieldName,'"+e.columnSortInactiveCssClass+"':gridOptions.orderBy!=columnOptions.fieldName,'"+e.columnSortNormalOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&!gridOptions.orderByReverse,'"+e.columnSortReverseOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&gridOptions.orderByReverse}\" >  </div></div>"),D(s,o,e.cellFooterTemplateId,'<div class="'+e.footerCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <span '+e.globalFilterDirectiveAttribute+'=""></span>    <span '+e.pagerDirectiveAttribute+'=""></span>  </div></div>'),D(s,o,e.footerGlobalFilterTemplateId,'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" ng-keypress="speedUpAsyncDataRetrieval($event)" ng-attr-placeholder="{{\'Search\'|'+e.translateFilter+':gridOptions.locale}}"></input></span>'),D(s,o,e.footerPagerTemplateId,'<span class="pull-right form-group"> <ul class="pagination">   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(0)" ng-attr-title="{{\'First Page\'|'+e.translateFilter+':gridOptions.locale}}">         <span>&laquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(gridOptions.currentPage - 1)" ng-attr-title="{{\'Previous Page\'|'+e.translateFilter+':gridOptions.locale}}">         <span>&lsaquo;</span>     </a>   </li>   <li ng-if="pageSelectionActive" ng-repeat="pageIndex in pageIndexes track by $index" ng-class="{disabled:pageIndex===null, active:pageIndex===gridOptions.currentPage}">      <span ng-if="pageIndex===null">...</span>      <a href="" ng-click="navigateToPage(pageIndex)" ng-if="pageIndex!==null" ng-attr-title="{{\'Page\'|'+e.translateFilter+':gridOptions.locale}}">{{pageIndex+1}}</a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(gridOptions.currentPage + 1)" ng-attr-title="{{\'Next Page\'|'+e.translateFilter+':gridOptions.locale}}">         <span>&rsaquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(lastPageIndex)" ng-attr-title="{{\'Last Page\'|'+e.translateFilter+':gridOptions.locale}}">         <span>&raquo;</span>     </a>   </li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">{{\'لم يتم العثور على شيء\'|'+e.translateFilter+":gridOptions.locale}}</span>     <span ng-show=\"totalItemsCount\">       {{'عرض'|"+e.translateFilter+":gridOptions.locale}} {{startItemIndex+1}} - {{endItemIndex+1}}        <span>{{'من أصل'|"+e.translateFilter+":gridOptions.locale}} {{totalItemsCount}} </span>     </span >    </li> </ul></span>"),r=!0)}return t.prototype.setupGrid=function(t,r,n){return this.gridOptions=r,this.isInServerSideMode=n,t.gridOptions=r,t.TrNgGrid=e,r.gridColumnDefs=[],void 0===r.locale&&(r.locale="en"),void 0===r.selectionMode&&(r.selectionMode=i[i.MultiRow]),void 0===r.filterByFields&&(r.filterByFields={}),void 0===r.enableFiltering&&(r.enableFiltering=!0),void 0===r.enableSorting&&(r.enableSorting=!0),void 0===r.onDataRequiredDelay&&(r.onDataRequiredDelay=1e3),void 0===r.selectedItems&&(r.selectedItems=[]),void 0===r.currentPage&&(r.currentPage=0),this.setupServerSideModeTriggers(t),this.setupDataFilteringTriggers(t),this.setupDataFormattingTriggers(t),this.setupDataSelectionTriggers(t),t},t.prototype.setupDataFilteringTriggers=function(e){var t=this,i=!1;if(this.scheduleDataFiltering=function(){i||(e.$evalAsync(function(){i=!1,t.computeFilteredItems(e)}),i=!0)},!this.isInServerSideMode){var r=!0;e.$watchCollection("[gridOptions.filterBy,gridOptions.filterByFields,gridOptions.orderBy,gridOptions.orderByReverse,gridOptions.pageItems]",function(e,i){r?r=!1:(t.gridOptions.currentPage=0,t.scheduleDataFiltering())}),e.$watch("gridOptions.currentPage",function(e,i){e!==i&&t.scheduleDataFiltering()})}},t.prototype.setupDataFormattingTriggers=function(t){var i=this,r=!1;this.scheduleDataFormatting=function(){r||(t.$evalAsync(function(){r=!1,i.computeFormattedItems(t)}),r=!0)};var n="[gridOptions.items,gridOptions.gridColumnDefs.length";angular.forEach(t.gridOptions.gridColumnDefs,function(e){if(e.displayFormat&&"."!=e.displayFormat[0]){var t=e.displayFormat.split("|");angular.forEach(t,function(e){var t=e.split(":");t.length>1&&angular.forEach(t.slice(1),function(e){(e=e.trim())&&"gridItem"!==e&&"gridDisplayItem"!==e&&(n+=","+e)})})}}),n+="]",e.debugMode&&this.log("re-formatting is set to watch for changes in "+n),t.$watch(n,function(){return i.scheduleDataFormatting()},!0)},t.prototype.setupServerSideModeTriggers=function(t){var i=this;if(this.isInServerSideMode){var r=null,n=!1,l=!1,a=!1,s=function(){r&&(i.$timeout.cancel(r),r=null)},o=function(){e.debugMode&&i.log("Preparing to request data - server side mode"),s();var r=function(){t.$applyAsync(function(){n=!1;try{e.debugMode&&i.log("Requesting data - server side mode"),i.gridOptions.onDataRequired(i.gridOptions)}catch(t){throw e.debugMode&&i.log("Data retrieval failed "+t),t}})};a?t.$evalAsync(function(){e.debugMode&&i.log("Resetting the page index - server side mode"),t.gridOptions.currentPage=0,a=!1,r()}):r()};this.scheduleServerSideModeDataRetrieval=function(){n||(s(),r=i.$timeout(function(){r=null,n=!0,o()},i.gridOptions.onDataRequiredDelay,!0),l&&i.speedUpServerSideModeDataRetrieval())},this.speedUpServerSideModeDataRetrieval=function(e){e&&13!=e.keyCode||(r?(l=!1,s(),n=!0,o()):l=!0)},t.$watch("gridOptions.currentPage",function(t,r){t!==r&&(e.debugMode&&i.log("Changes detected in the current page index in server-side mode. Scheduling data retrieval..."),i.scheduleServerSideModeDataRetrieval())});var d=!0;t.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.pageItems]",function(t,r){d?d=!1:(0!==i.gridOptions.currentPage&&(e.debugMode&&i.log("Changes detected in parameters in server-side mode. Requesting a page index reset..."),a=!0),e.debugMode&&i.log("Changes detected in parameters in server-side mode. Scheduling data retrieval..."),i.scheduleServerSideModeDataRetrieval())}),this.scheduleServerSideModeDataRetrieval(),this.speedUpServerSideModeDataRetrieval()}else this.speedUpServerSideModeDataRetrieval=function(e){};t.speedUpAsyncDataRetrieval=function(e){return i.speedUpServerSideModeDataRetrieval(e)}},t.prototype.setupDataSelectionTriggers=function(e){var t=this;e.$watch("gridOptions.selectionMode",function(e,r){if(e!==r)switch(e){case i[i.None]:t.gridOptions.selectedItems.splice(0);break;case i[i.SingleRow]:t.gridOptions.selectedItems.length>1&&t.gridOptions.selectedItems.splice(1)}})},t.prototype.setColumnOptions=function(e,t){var i=this.gridOptions.gridColumnDefs[e];if(!i)throw"Invalid grid column options found for column index "+e+". Please report this error.";t=angular.extend(t,i),this.gridOptions.gridColumnDefs[e]=t},t.prototype.toggleSorting=function(e){this.gridOptions.orderBy!=e?this.gridOptions.orderBy=e:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse,this.speedUpServerSideModeDataRetrieval()},t.prototype.toggleItemSelection=function(e,t,r){if(this.gridOptions.selectionMode!==i[i.None])switch(this.gridOptions.selectionMode){case i[i.MultiRowWithKeyModifiers]:if(r.ctrlKey||r.shiftKey||r.metaKey){if(r.ctrlKey||r.metaKey)(g=this.gridOptions.selectedItems.indexOf(t))>=0?this.gridOptions.selectedItems.splice(g,1):this.gridOptions.selectedItems.push(t);else if(r.shiftKey){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){window.getSelection().removeAllRanges()}var n,l,a=this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1];for(n=0;n<e.length&&e[n].$$_gridItem!==a;n++);for(n>=e.length&&(n=0),l=0;l<e.length&&e[l].$$_gridItem!==t;l++);if(l>=e.length)throw"Invalid selection on a key modifier selection mode";if(l<n){var s=n;n=l,l=s}for(var o=n;o<=l;o++){var d=e[o].$$_gridItem;this.gridOptions.selectedItems.indexOf(d)<0&&this.gridOptions.selectedItems.push(d)}}}else{var g=this.gridOptions.selectedItems.indexOf(t);this.gridOptions.selectedItems.splice(0),g<0&&this.gridOptions.selectedItems.push(t)}break;case i[i.SingleRow]:g=this.gridOptions.selectedItems.indexOf(t);this.gridOptions.selectedItems.splice(0),g<0&&this.gridOptions.selectedItems.push(t);break;case i[i.MultiRow]:(g=this.gridOptions.selectedItems.indexOf(t))>=0?this.gridOptions.selectedItems.splice(g,1):this.gridOptions.selectedItems.push(t)}},t.prototype.discoverTemplates=function(e){this.templatedHeader=new C("thead",null,null,"th","tr-ng-grid-header-cell"),this.templatedBody=new C("tbody",l,null,"td","tr-ng-grid-body-cell"),this.templatedFooter=new C("tfoot",null,null,"td","tr-ng-grid-footer-cell"),this.templatedHeader.discoverTemplates(e),this.templatedFooter.discoverTemplates(e),this.templatedBody.discoverTemplates(e)},t.prototype.getSafeFieldName=function(e){return e.replace(/[^a-zA-Z0-9]/g,"_")},t.prototype.configureTableStructure=function(t,i,r){var n=this;try{if(i.empty(),r){var a=r;this.$timeout(function(){a.$destroy()}),r=null}var s=t.$new();this.columnDefsItemsWatcherDeregistration&&(this.columnDefsItemsWatcherDeregistration(),this.columnDefsItemsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration&&(this.columnDefsFieldsWatcherDeregistration(),this.columnDefsFieldsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration=s.$watch("gridOptions.fields",function(e,r){angular.equals(e,r)||n.configureTableStructure(t,i,s)},!0);var o=this.templatedHeader.extractPartialColumnDefinitions(),d=this.templatedBody.extractPartialColumnDefinitions(),g=this.templatedFooter.extractPartialColumnDefinitions(),c=[];if(this.gridOptions.fields)angular.forEach(this.gridOptions.fields,function(e){e&&c.push({isStandardColumn:!0,fieldName:e})}),c=I(c,o,!1,!0),c=I(c,d,!1,!0);else if(o.length>0)c=I(o,d,!0,!0);else{if(!this.gridOptions.items||0==this.gridOptions.items.length)return void(this.columnDefsItemsWatcherDeregistration=s.$watch("gridOptions.items.length",function(e,r){e&&n.configureTableStructure(t,i,s)}));for(var u in this.gridOptions.items[0])c.push({isStandardColumn:!0,fieldName:u});c=I(c,d,!0,!0)}0==g.length&&g.push({isStandardColumn:!0}),angular.forEach(c,function(e){if(e.fieldName){var t,i=e.fieldName;e.displayFieldName=n.getSafeFieldName(i),t="["===i[0]?i:i.replace(/^([^\.]+)/g,'["$1"]'),e.fieldExtractionExpression=t}}),this.gridOptions.gridColumnDefs=c;var p=this.templatedHeader.configureSection(i,c),m=this.templatedFooter.configureSection(i,g),f=this.templatedBody.configureSection(i,c),h=this.templatedBody.getTemplatedRowElement(f);this.templatedHeader.getTemplatedRowElement(p);f.attr(l,""),h.attr("ng-click","toggleItemSelection(gridItem, $event)"),h.attr("ng-repeat","gridDisplayItem in filteredItems"),h.attr("ng-init","gridItem=gridDisplayItem.$$_gridItem;"+h.attr("ng-init"));var v=h.attr("ng-class");v=(v||"").replace(/^(\s*\{?)(.*?)(\}?\s*)$/,"{'"+e.rowSelectedCssClass+"':gridOptions.selectedItems.indexOf(gridItem) >= 0, $2}"),h.attr("ng-class",v),this.$compile(p)(s),this.$compile(m)(s),this.$compile(f)(s)}catch(t){throw e.debugMode&&this.log("Fixing table structure failed with error "+t),t}},t.prototype.computeFormattedItems=function(t){var i=t.gridOptions.items||[];e.debugMode&&this.log("formatting items of length "+i.length);try{for(var r=t.formattedItems=t.formattedItems||[],n=t.gridOptions.gridColumnDefs,l=0;l<i.length;l++){for(var a,s=i[l],o={gridItem:s};r.length>i.length&&(a=r[l]).$$_gridItem!==s;)r.splice(l,1);l<r.length?(a=r[l]).$$_gridItem!==s&&(a={$$_gridItem:s},r[l]=a):(a={$$_gridItem:s},r.push(a));for(var d=0;d<n.length;d++){try{var g=n[d];if(g.displayFieldName&&g.fieldExtractionExpression){var c=g.displayFormat;c&&"."!==c[0]&&"|"!==c[0]&&"["!==c[0]&&(c=" | "+c),a[g.displayFieldName]=t.$eval("gridItem"+g.fieldExtractionExpression+(c||""),o)}}catch(t){e.debugMode&&this.log("Field evaluation failed for <unknown> with error "+t)}}}r.length>i.length&&r.splice(i.length,r.length-i.length),this.scheduleDataFiltering()}catch(t){throw e.debugMode&&this.log("Failed to format items "+t),t}},t.prototype.extractDataItems=function(e){var t;if(e){t=new Array(e.length);for(var i=0;i<e.length;i++)t[i]=e[i].$$_gridItem}else t=[];return t},t.prototype.computeFilteredItems=function(t){try{if(this.isInServerSideMode)t.filteredItems=t.formattedItems;else{if(t.filterByDisplayFields={},t.gridOptions.filterByFields)for(var i in t.gridOptions.filterByFields)t.filterByDisplayFields[this.getSafeFieldName(i)]=t.gridOptions.filterByFields[i];e.debugMode&&this.log("filtering items of length "+(t.formattedItems?t.formattedItems.length:0)),t.filteredItems=t.$eval("formattedItems | filter:gridOptions.filterBy | filter:filterByDisplayFields | "+e.sortFilter+":gridOptions"),t.gridOptions.filteredItems&&(t.gridOptions.filteredItems=this.extractDataItems(t.filteredItems)),t.filteredItems=t.$eval("filteredItems | "+e.dataPagingFilter+":gridOptions")}t.gridOptions.filteredItemsPage&&(t.gridOptions.filteredItemsPage=this.extractDataItems(t.filteredItems))}catch(t){throw e.debugMode&&this.log("Failed to filter items "+t),t}},t.prototype.linkAttrs=function(e,t){var i=function(e,i){if(void 0!==i){switch(i){case"true":i=!0;break;case"false":i=!1}t[e]=i}};for(var r in t)i(r,e[r]),function(t){e.$observe(t,function(e){return i(t,e)})}(r)},t.prototype.log=function(e){console.log(n+"("+(new Date).getTime()+"): "+e)},t}();function D(e,t,i,r){var n=t.startSymbol(),l=t.endSymbol();e.get(i)||("{{"!==n&&(r=r.replace(/\{\{/g,n+" ")),"}}"!==l&&(r=r.replace(/\}\}/g," "+l)),e.put(i,r))}angular.module("trNgGrid",[]).directive(n,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filteredItems:"=?",filteredItemsPage:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",selectionMode:"@",locale:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"},controller:["$compile","$parse","$timeout","$templateCache","$interpolate",F],compile:function(t,i){return angular.forEach(t.children(),function(e){(e=angular.element(e)).attr("ng-non-bindable","")}),{pre:function(e,t,i,r,n){r.discoverTemplates(t)},post:function(t,i,r,n,l){i.addClass(e.tableCssClass);var a=t.$parent.$new();n.setupGrid(a,t,!!r.onDataRequired),n.configureTableStructure(a,i),t.$on("$destroy",function(){a.$destroy(),e.debugMode&&n.log("grid scope destroyed")})}}}}}]).directive(c,[function(){return{restrict:"A",require:"^"+n,scope:!0,compile:function(t,i){var r="true"==i.isCustomized;return O(t,0,r,"tr-ng-grid-header-cell-template"),{pre:function(t,i,n,l,a){var s=parseInt(n[c]),o=angular.extend(t.gridOptions.gridColumnDefs[s],e.defaultColumnOptionsTemplate,e.defaultColumnOptions);l.linkAttrs(n,o),t.columnOptions=o,t.isCustomized=r,t.toggleSorting=function(e){l.toggleSorting(e)},t.$watch("columnOptions.displayName",function(){!function(e){if(e.columnOptions.displayName)e.columnTitle=e.columnOptions.displayName;else if(e.columnOptions.fieldName){var t=e.columnOptions.fieldName.replace(/^([^\a-zA-Z]*)([\a-zA-Z0-9]*)(.*)/g,"$2").split(/(?=[A-Z])/);t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),e.columnTitle=t.join(" ")}else e.columnTitle=""}(t)});var d=!1;t.$watch("gridOptions.filterByFields['"+o.fieldName+"']",function(e,i){o.filter!==e&&(o.filter=e),d||(t.$watch("columnOptions.filter",function(e,i){t.gridOptions.filterByFields[o.fieldName]!==e&&(e?t.gridOptions.filterByFields[o.fieldName]=e:delete t.gridOptions.filterByFields[o.fieldName],t.gridOptions.filterByFields=angular.extend({},t.gridOptions.filterByFields))}),d=!0)})}}}}}]).directive(u,[function(){return{restrict:"A",templateUrl:e.cellHeaderTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridBody",[function(){return{restrict:"A",require:"^"+n,scope:!0,compile:function(e,t){return{pre:function(e,t,i,r){e.toggleItemSelection=function(t,i){r.toggleItemSelection(e.filteredItems,t,i)}}}}}}]).directive(p,[function(){return{restrict:"A",require:"^"+n,scope:!0,compile:function(e,t){var i="true"==t.isCustomized;return O(e,0,i,"tr-ng-grid-body-cell-template"),{pre:function(e,t,r,n,l){e.columnOptions=e.gridOptions.gridColumnDefs[parseInt(r[p])],e.gridItem=e.gridDisplayItem.$$_gridItem,e.isCustomized=i}}}}}]).directive(m,[function(){return{restrict:"A",templateUrl:e.cellBodyTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridFooterCell",[function(){return{restrict:"A",require:"^"+n,scope:!0,compile:function(e,t){var i="true"==t.isCustomized;return O(e,0,i,"tr-ng-grid-footer-cell-template"),{pre:function(e,t,r,n,l){e.isCustomized=i,t.attr("colspan",e.gridOptions.gridColumnDefs.length)}}}}}]).directive(o,[function(){return{restrict:"A",templateUrl:e.cellFooterTemplateId,transclude:!0,replace:!0}}]).directive(f,[function(){return{restrict:"A",replace:!0,templateUrl:e.columnSortTemplateId}}]).directive(h,[function(){return{restrict:"A",replace:!0,templateUrl:e.columnFilterTemplateId}}]).directive(d,[function(){return{restrict:"A",scope:!1,templateUrl:e.footerGlobalFilterTemplateId}}]).directive(g,[function(){var t=function(t,i){if(t.totalItemsCount=void 0!==t.gridOptions.totalItems&&null!=t.gridOptions.totalItems?t.gridOptions.totalItems:t.gridOptions.items?t.gridOptions.items.length:0,t.isPaged=!!t.gridOptions.pageItems&&t.gridOptions.pageItems<t.totalItemsCount,t.extendedControlsActive=!1,t.lastPageIndex=t.totalItemsCount&&t.isPaged?Math.floor(t.totalItemsCount/t.gridOptions.pageItems)+(t.totalItemsCount%t.gridOptions.pageItems?0:-1):0,t.gridOptions.currentPage>t.lastPageIndex&&(e.debugMode&&i.log("The current page index falls outside of the range of items. Either the attached parameter has a wrong value or the total items count is not properly set in server side mode."),t.gridOptions.currentPage=t.lastPageIndex),t.startItemIndex=t.isPaged?t.gridOptions.pageItems*t.gridOptions.currentPage:0,t.endItemIndex=t.isPaged?t.startItemIndex+t.gridOptions.pageItems-1:t.totalItemsCount-1,t.endItemIndex>=t.totalItemsCount&&(t.endItemIndex=t.totalItemsCount-1),t.endItemIndex<t.startItemIndex&&(t.endItemIndex=t.startItemIndex),t.pageCanGoBack=t.isPaged&&t.gridOptions.currentPage>0,t.pageCanGoForward=t.isPaged&&t.gridOptions.currentPage<t.lastPageIndex,t.pageIndexes=t.pageIndexes||[],t.pageIndexes.splice(0),t.isPaged)if(t.lastPageIndex+1>e.defaultPagerMinifiedPageCountThreshold){t.extendedControlsActive=!0;var r=Math.floor(e.defaultPagerMinifiedPageCountThreshold/2),n=t.gridOptions.currentPage-r,l=t.gridOptions.currentPage+r;n<0?(l+=-n,n=0):l>t.lastPageIndex&&(n-=l-t.lastPageIndex,l=t.lastPageIndex),n>0&&(t.pageIndexes.push(null),n++);var a=!1;l<t.lastPageIndex&&(a=!0,l--);for(var s=n;s<=l;s++)t.pageIndexes.push(s);a&&t.pageIndexes.push(null)}else{t.extendedControlsActive=!1;for(s=0;s<=t.lastPageIndex;s++)t.pageIndexes.push(s)}t.pageSelectionActive=t.pageIndexes.length>1,t.navigateToPage=function(e){t.gridOptions.currentPage=e,t.speedUpAsyncDataRetrieval()},t.switchPageSelection=function(e,i){t.pageSelectionActive=i,e&&(e.preventDefault(),e.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+n,templateUrl:e.footerPagerTemplateId,replace:!0,compile:function(e,i){return{pre:function(e,i,r,n){t(e,n)},post:function(e,i,r,n){e.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(i,r){t(e,n)})}}}}}]).filter(e.sortFilter,["$filter","$parse",function(e,t){return function(i,r){if(!r.orderBy||!r.gridColumnDefs)return i;for(var n=null,l=0;l<r.gridColumnDefs.length&&(n=r.gridColumnDefs[l]).fieldName!==r.orderBy;n=null,l++);return n?e("orderBy")(i,function(e){var i=void 0;if(n.fieldExtractionExpression)try{i=t("item.$$_gridItem"+n.fieldExtractionExpression)({item:e})}catch(e){}if(void 0===i)try{i=t('item["'+n.displayFieldName+'"]')({item:e})}catch(e){}return i},r.orderByReverse):i}}]).filter(e.dataPagingFilter,function(){return function(e,t){if(e&&(t.totalItems=e.length),!t.pageItems||!e||0==e.length)return e;t.currentPage||(t.currentPage=0);var i=t.currentPage*t.pageItems;i>=e.length&&(t.currentPage=0,i=0);var r=t.currentPage*t.pageItems+t.pageItems;return e.slice(i,r)}}).filter(e.translateFilter,["$filter","$injector",function(t,i){return function(r,n){var l=null;if(!n)throw"Language identifier is not set";if(r instanceof Date){var a=t(e.translateFilter)(e.translationDateFormat,n);return a&&a!==e.translationDateFormat?l=t("date")(r,a):r}for(var s=n.split(/[-_]/),o=s.length;o>0&&!l;o--){var d=s.slice(0,o).join("-"),g=e.translations[d];g&&(l=g[r])}if(!l&&i.has("translateFilter"))try{l=t("translate")(r)}catch(e){}return l||(l=r),l}}]).run(function(){e.tableCssClass="tr-ng-grid table table-bordered table-hover table-striped",e.cellCssClass="tr-ng-cell",e.headerCellCssClass="tr-ng-column-header "+e.cellCssClass,e.bodyCellCssClass=e.cellCssClass,e.columnTitleCssClass="tr-ng-title",e.columnSortCssClass="tr-ng-sort",e.columnFilterCssClass="tr-ng-column-filter",e.columnFilterInputWrapperCssClass="",e.columnSortActiveCssClass="tr-ng-sort-active text-info",e.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted fa fa-chevron-down",e.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse fa fa-chevron-down",e.columnSortNormalOrderCssClass="tr-ng-sort-order-normal fa fa-chevron-up",e.rowSelectedCssClass="active",e.footerCssClass="tr-ng-grid-footer form-inline"}).run(function(){e.defaultColumnOptions.displayAlign="right",e.defaultPagerMinifiedPageCountThreshold=3})}(TrNgGrid||(TrNgGrid={}));